import{_ as Z}from"./CpIcon.65695a50.js";import{_ as ee}from"./CpNavBar.e59f99e4.js";import{_ as te}from"./avatar-doctor.6805bde9.js";import{a as ne,c as ae,b as ue}from"./consult.95ebbc64.js";import{c as le}from"./user.dfe0b079.js";import{d as C,c as e,E as W,x as oe,I as G,r as h,L as se,v as re,S as ie,h as ce,o as N,a as R,b as m,t as U,w as b,e as de,g as z,_ as pe}from"./index.704bf49d.js";import{c as me,s as ve}from"./function-call.2cae2cfb.js";import"./index.3ca281aa.js";import{C as fe}from"./index.4b6ed35c.js";import{p as _e,b as be,P as ye,L as Fe,e as Ee,s as V,f as ge}from"./request.3cade431.js";import{c as A,f as he,t as B,z as Be,m as P,D as Ce,I,H as De,w as k,a1 as Ae,k as M,n as w,G as ke,e as j}from"./index.e27673f9.js";import{B as q}from"./index.6b080f53.js";import{u as Se}from"./use-placeholder.efae37ec.js";import{C as xe}from"./index.931ef82a.js";import"./use-route.123cb7a7.js";import"./interceptor.d8cac4bc.js";const[Pe,v]=A("action-sheet"),we=he({},_e,{title:String,round:B,actions:Be(),closeIcon:P("cross"),closeable:B,cancelText:String,description:String,closeOnPopstate:B,closeOnClickAction:Boolean,safeAreaInsetBottom:B}),Te=[...be,"round","closeOnPopstate","safeAreaInsetBottom"];var $e=C({name:Pe,props:we,emits:["select","cancel","update:show"],setup(t,{slots:n,emit:u}){const d=a=>u("update:show",a),i=()=>{d(!1),u("cancel")},_=()=>{if(t.title)return e("div",{class:v("header")},[t.title,t.closeable&&e(I,{name:t.closeIcon,class:[v("close"),De],onClick:i},null)])},y=()=>{if(n.cancel||t.cancelText)return[e("div",{class:v("gap")},null),e("button",{type:"button",class:v("cancel"),onClick:i},[n.cancel?n.cancel():t.cancelText])]},F=a=>{if(a.icon)return e(I,{class:v("item-icon"),name:a.icon},null)},c=(a,p)=>a.loading?e(Fe,{class:v("loading-icon")},null):n.action?n.action({action:a,index:p}):[e("span",{class:v("name")},[a.name]),a.subname&&e("div",{class:v("subname")},[a.subname])],o=(a,p)=>{const{color:S,loading:D,callback:s,disabled:l,className:g}=a,E=()=>{l||D||(s&&s(a),t.closeOnClickAction&&d(!1),oe(()=>u("select",a,p)))};return e("button",{type:"button",style:{color:S},class:[v("item",{loading:D,disabled:l}),g],onClick:E},[F(a),c(a,p)])},r=()=>{if(t.description||n.description){const a=n.description?n.description():t.description;return e("div",{class:v("description")},[a])}};return()=>e(ye,W({class:v(),position:"bottom","onUpdate:show":d},Ce(t,Te)),{default:()=>{var a;return[_(),r(),e("div",{class:v("content")},[t.actions.map(o),(a=n.default)==null?void 0:a.call(n)]),y()]}})}});const Ie=k($e),[We,H]=A("cell-group"),Oe={title:String,inset:Boolean,border:B};var Le=C({name:We,inheritAttrs:!1,props:Oe,setup(t,{slots:n,attrs:u}){const d=()=>{var _;return e("div",W({class:[H({inset:t.inset}),{[Ae]:t.border&&!t.inset}]},u,Ee()),[(_=n.default)==null?void 0:_.call(n)])},i=()=>e("div",{class:H("title",{inset:t.inset})},[n.title?n.title():t.title]);return()=>t.title||n.title?e(G,null,[i(),d()]):d()}});const Ne=k(Le),[Re,Ue]=A("skeleton-title"),ze={round:Boolean,titleWidth:w};var Ve=C({name:Re,props:ze,setup(t){return()=>e("h3",{class:Ue([{round:t.round}]),style:{width:M(t.titleWidth)}},null)}});const He=k(Ve);var Ke=He;const[Ge,Me]=A("skeleton-avatar"),je={avatarSize:w,avatarShape:P("round")};var qe=C({name:Ge,props:je,setup(t){return()=>e("div",{class:Me([t.avatarShape]),style:ke(t.avatarSize)},null)}});const Je=k(qe);var Qe=Je;const O="100%",Xe={round:Boolean,rowWidth:{type:w,default:O}},[Ye,Ze]=A("skeleton-paragraph");var et=C({name:Ye,props:Xe,setup(t){return()=>e("div",{class:Ze([{round:t.round}]),style:{width:t.rowWidth}},null)}});const tt=k(et);var nt=tt;const[at,K]=A("skeleton"),ut="60%",lt={row:j(0),round:Boolean,title:Boolean,titleWidth:w,avatar:Boolean,avatarSize:w,avatarShape:P("round"),loading:B,animate:B,rowWidth:{type:[Number,String,Array],default:O}};var ot=C({name:at,inheritAttrs:!1,props:lt,setup(t,{slots:n,attrs:u}){const d=()=>{if(t.avatar)return e(Qe,{avatarShape:t.avatarShape,avatarSize:t.avatarSize},null)},i=()=>{if(t.title)return e(Ke,{round:t.round,titleWidth:t.titleWidth},null)},_=c=>{const{rowWidth:o}=t;return o===O&&c===+t.row-1?ut:Array.isArray(o)?o[c]:o},y=()=>Array(+t.row).fill("").map((c,o)=>e(nt,{key:o,round:t.round,rowWidth:M(_(o))},null)),F=()=>n.template?n.template():e(G,null,[d(),e("div",{class:K("content")},[i(),y()])]);return()=>{var c;return t.loading?e("div",W({class:K({animate:t.animate,round:t.round})},u),[F()]):(c=n.default)==null?void 0:c.call(n)}}});const st=k(ot),[rt,f,it]=A("submit-bar"),ct={tip:String,label:String,price:Number,tipIcon:String,loading:Boolean,currency:P("\xA5"),disabled:Boolean,textAlign:String,buttonText:String,buttonType:P("danger"),buttonColor:String,suffixLabel:String,placeholder:Boolean,decimalLength:j(2),safeAreaInsetBottom:B};var dt=C({name:rt,props:ct,emits:["submit"],setup(t,{emit:n,slots:u}){const d=h(),i=Se(d,f),_=()=>{const{price:r,label:a,currency:p,textAlign:S,suffixLabel:D,decimalLength:s}=t;if(typeof r=="number"){const l=(r/100).toFixed(+s).split("."),g=s?`.${l[1]}`:"";return e("div",{class:f("text"),style:{textAlign:S}},[e("span",null,[a||it("label")]),e("span",{class:f("price")},[p,e("span",{class:f("price-integer")},[l[0]]),g]),D&&e("span",{class:f("suffix-label")},[D])])}},y=()=>{var r;const{tip:a,tipIcon:p}=t;if(u.tip||a)return e("div",{class:f("tip")},[p&&e(I,{class:f("tip-icon"),name:p},null),a&&e("span",{class:f("tip-text")},[a]),(r=u.tip)==null?void 0:r.call(u)])},F=()=>n("submit"),c=()=>u.button?u.button():e(q,{round:!0,type:t.buttonType,text:t.buttonText,class:f("button",t.buttonType),color:t.buttonColor,loading:t.loading,disabled:t.disabled,onClick:F},null),o=()=>{var r,a;return e("div",{ref:d,class:[f(),{"van-safe-area-bottom":t.safeAreaInsetBottom}]},[(r=u.top)==null?void 0:r.call(u),y(),e("div",{class:f("bar")},[(a=u.default)==null?void 0:a.call(u),_(),c()])])};return()=>t.placeholder?i(o):o()}});const pt=k(dt),mt={key:0,class:"consult-pay-page"},vt={class:"pay-info"},ft={class:"tit"},_t={class:"pay-schema"},bt={class:"pay-type"},yt={class:"amount"},Ft={class:"btn"},Et={key:1},gt=C({__name:"ConsultPay",setup(t){const n=h(),u=se(),d=async()=>{const s=await ne({type:u.consult.type,illnessType:u.consult.illnessType});n.value=s.data,u.setCoupon(s.data.couponId)};re(()=>{if(!["type","illnessType","depId","illnessDesc","illnessTime","consultFlag","patientId"].every(g=>u.consult[g]!==void 0))return me({title:"\u6E29\u99A8\u63D0\u793A",message:"\u95EE\u8BCA\u4FE1\u606F\u4E0D\u5B8C\u6574\u8BF7\u91CD\u65B0\u586B\u5199\uFF0C\u5982\u6709\u672A\u652F\u4ED8\u7684\u95EE\u8BCA\u8BA2\u5355\u53EF\u5728\u95EE\u8BCA\u8BB0\u5F55\u4E2D\u7EE7\u7EED\u652F\u4ED8\uFF01",closeOnPopstate:!1}).then(()=>{p.push("/")});d(),_()});const i=h(),_=async()=>{if(!u.consult.patientId)return;const s=await le(u.consult.patientId);i.value=s.data},y=h(!1),F=h(!1),c=h(!1),o=h(),r=h(""),a=async()=>{if(!y.value)return V("\u8BF7\u52FE\u9009\u534F\u8BAE");c.value=!0;const s=await ae(u.consult);r.value=s.data.id,c.value=!1,u.clear(),F.value=!0};ie(()=>{if(r.value)return!1});const p=ce(),S=()=>ve({title:"\u5173\u95ED\u652F\u4ED8",message:"\u53D6\u6D88\u652F\u4ED8\u5C06\u65E0\u6CD5\u83B7\u5F97\u533B\u751F\u56DE\u590D\uFF0C\u533B\u751F\u63A5\u8BCA\u540D\u989D\u6709\u9650\uFF0C\u662F\u5426\u786E\u8BA4\u5173\u95ED\uFF1F",cancelButtonText:"\u4ECD\u8981\u5173\u95ED",confirmButtonText:"\u7EE7\u7EED\u652F\u4ED8"}).then(()=>!1).catch(()=>(r.value="",p.push("/user/consult"),!0)),D=async()=>{if(!o.value)return V("\u8BF7\u9009\u62E9\u652F\u4ED8\u65B9\u5F0F");ge({message:"\u8DF3\u8F6C\u652F\u4ED8",duration:0});const s=await ue({orderId:r.value,paymentMethod:o.value,payCallback:"http://localhost:5173/room"});window.location.href=s.data.payUrl};return(s,l)=>{const g=ee,E=fe,T=Ne,$=xe,J=pt,L=Z,Q=q,X=Ie,Y=st;return i.value&&n.value?(N(),R("div",mt,[e(g,{title:"\u652F\u4ED8"}),m("div",vt,[m("p",ft,"\u56FE\u6587\u95EE\u8BCA "+U(n.value.payment)+" \u5143",1),l[4]||(l[4]=m("img",{class:"img",src:te},null,-1)),l[5]||(l[5]=m("p",{class:"desc"},[m("span",null,"\u6781\u901F\u95EE\u8BCA"),m("span",null,"\u81EA\u52A8\u5206\u914D\u533B\u751F")],-1))]),e(T,null,{default:b(()=>[e(E,{title:"\u4F18\u60E0\u5238",value:`-\xA5${n.value.couponDeduction}`},null,8,["value"]),e(E,{title:"\u79EF\u5206\u62B5\u6263",value:`-\xA5${n.value.pointDeduction}`},null,8,["value"]),e(E,{title:"\u5B9E\u4ED8\u6B3E",value:`-\xA5${n.value.actualPayment}`,class:"pay-price"},null,8,["value"])]),_:1}),l[8]||(l[8]=m("div",{class:"pay-space"},null,-1)),e(T,null,{default:b(()=>[e(E,{title:"\u60A3\u8005\u4FE1\u606F",value:`${i.value.name}| ${i.value.genderValue} | ${i.value.age}\u5C81`},null,8,["value"]),e(E,{title:"\u75C5\u60C5\u63CF\u8FF0",label:de(u).consult.illnessDesc},null,8,["label"])]),_:1}),m("div",_t,[e($,{modelValue:y.value,"onUpdate:modelValue":l[0]||(l[0]=x=>y.value=x)},{default:b(()=>l[6]||(l[6]=[z("\u6211\u5DF2\u540C\u610F "),m("span",{class:"text"},"\u652F\u4ED8\u534F\u8BAE",-1)])),_:1},8,["modelValue"])]),e(J,{"button-type":"primary",price:n.value.actualPayment*100,"button-text":"\u7ACB\u5373\u652F\u4ED8","text-align":"left",onClick:a},null,8,["price"]),e(X,{show:F.value,"onUpdate:show":l[3]||(l[3]=x=>F.value=x),title:"\u9009\u62E9\u652F\u4ED8\u65B9\u5F0F","close-on-popstate":!1,closeable:!1,"before-close":S},{default:b(()=>[m("div",bt,[m("p",yt,"\uFFE5 "+U(n.value.actualPayment.toFixed(2)),1),e(T,null,{default:b(()=>[e(E,{title:"\u5FAE\u4FE1\u652F\u4ED8",onClick:l[1]||(l[1]=x=>o.value=0)},{icon:b(()=>[e(L,{name:"consult-wechat"})]),extra:b(()=>[e($,{checked:o.value===0},null,8,["checked"])]),_:1}),e(E,{title:"\u652F\u4ED8\u5B9D\u652F\u4ED8",onClick:l[2]||(l[2]=x=>o.value=1)},{icon:b(()=>[e(L,{name:"consult-alipay"})]),extra:b(()=>[e($,{checked:o.value===1},null,8,["checked"])]),_:1})]),_:1}),m("div",Ft,[e(Q,{type:"primary",round:"",block:"",loading:c.value,onClick:D},{default:b(()=>l[7]||(l[7]=[z("\u7ACB\u5373\u652F\u4ED8")])),_:1},8,["loading"])])])]),_:1},8,["show"])])):(N(),R("div",Et,[e(g,{title:"\u652F\u4ED8"}),e(Y,{title:"",row:10,style:{"margin-top":"10px"}})]))}}});const Nt=pe(gt,[["__scopeId","data-v-7e391ec7"]]);export{Nt as default};
