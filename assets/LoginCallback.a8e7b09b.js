import{_ as F}from"./CpNavBar.e59f99e4.js";import{u as V}from"./index.61caaf3f.js";import{f as x,h as A}from"./user.dfe0b079.js";import{d as D,r as n,v as L,u as M,o as U,a as N,c as a,b as l,w as d,e as o,t as R,n as h,g as w,M as E,i as Q,h as I,_ as S}from"./index.704bf49d.js";import{F as T,m as z,c as $}from"./rules.752667c5.js";import{a as j}from"./request.3cade431.js";import{F as q}from"./index.5b122279.js";import{B as G}from"./index.6b080f53.js";import"./use-placeholder.efae37ec.js";import"./index.e27673f9.js";import"./consult.95ebbc64.js";import"./interceptor.d8cac4bc.js";import"./index.4b6ed35c.js";import"./use-route.123cb7a7.js";import"./use-id.6dd5551f.js";const H={key:0,class:"login-page"},J={class:"cp-cell"},K=D({__name:"LoginCallback",setup(O){const u=n(),r=n(),i=n(""),p=n(!1);Q(),L(()=>{QC.Login.check()&&QC.Login.getMe(t=>{i.value=t,x(i.value).then(e=>{_(e.data)}).catch(()=>{p.value=!0})})});const b=async()=>{const t=await A({mobile:u.value,code:r.value,openId:i.value});_(t.data)},m=M(),C=I(),_=t=>{m.setUser(t),C.replace(m.returnUrl||"/user"),j("\u767B\u9646\u6210\u529F"),m.setReturnUrl("")},{time:c,form:B,sendCode:f}=V(u,"bindMobile");return(t,e)=>{const g=F,v=q,k=G,y=T;return p.value?(U(),N("div",H,[a(g),e[4]||(e[4]=l("div",{class:"login-head"},[l("h3",null,"\u624B\u673A\u7ED1\u5B9A")],-1)),a(y,{autocomplete:"off",ref_key:"form",ref:B},{default:d(()=>[a(v,{rules:o(z),modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s),name:"mobile",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"},null,8,["rules","modelValue"]),a(v,{rules:o($),modelValue:r.value,"onUpdate:modelValue":e[2]||(e[2]=s=>r.value=s),name:"code",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"},{button:d(()=>[l("span",{class:h(["btn-send",{active:o(c)>0}]),onClick:e[1]||(e[1]=(...s)=>o(f)&&o(f)(...s))},R(o(c)>0?`${o(c)}s\u540E\u91CD\u65B0\u53D1\u9001`:"\u53D1\u9001\u9A8C\u8BC1\u7801"),3)]),_:1},8,["rules","modelValue"]),l("div",J,[a(k,{style:{"margin-top":"50px"},block:"",round:"",type:"primary","native-type":"submit",onClick:b},{default:d(()=>e[3]||(e[3]=[w(" \u7ACB\u5373\u7ED1\u5B9A ")])),_:1})])]),_:1},512)])):E("",!0)}}});const me=S(K,[["__scopeId","data-v-c9f7f0b6"]]);export{me as default};
